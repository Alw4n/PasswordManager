-- composeApp/src/jvmMain/sqldelight/org/example/project/db/database.sq
package org.example.project.db

import kotlin.Long
import kotlin.String

/**
 * Таблица для хранения паролей и мастер-пароля
 */
CREATE TABLE master_password (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    hash TEXT NOT NULL,
    salt TEXT NOT NULL,
    created_at INTEGER NOT NULL
);

CREATE TABLE password_entries (
    id TEXT PRIMARY KEY,
    title TEXT NOT NULL,
    login TEXT NOT NULL,
    secret TEXT NOT NULL,
    notes TEXT,
    tags TEXT,
    created_at INTEGER NOT NULL,
    updated_at INTEGER NOT NULL
);

/**
 * Запросы для работы с мастер-паролем
 */
selectMasterPassword:
SELECT * FROM master_password
LIMIT 1;

insertMasterPassword:
INSERT INTO master_password(hash, salt, created_at)
VALUES (?, ?, ?);

updateMasterPassword:
UPDATE master_password
SET hash = ?, salt = ?, created_at = ?
WHERE id = ?;

/**
 * Запросы для работы с паролями
 */
selectAllPasswords:
SELECT * FROM password_entries;

insertPassword:
INSERT INTO password_entries(id, title, login, secret, notes, tags, created_at, updated_at)
VALUES (?, ?, ?, ?, ?, ?, ?, ?);

updatePassword:
UPDATE password_entries
SET title = ?, login = ?, secret = ?, notes = ?, tags = ?, updated_at = ?
WHERE id = ?;

deletePassword:
DELETE FROM password_entries WHERE id = ?;
